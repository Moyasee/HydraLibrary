import{c as h,r as p,d as b,g as w,i as I}from"./index-yATyr8au.js";async function B(){const e=new Date().getTime(),t=await fetch(`./data/resources.json?t=${e}`,{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!t.ok)throw new Error("Failed to fetch resources");return t.json()}window.addEventListener("load",async()=>{await h.initialize(),y()});function x(){const t={origin:{y:.7},spread:360,ticks:100,gravity:0,decay:.94,startVelocity:30};function n(a,s){confetti({...t,...s,particleCount:Math.floor(200*a)})}n(.25,{spread:26,startVelocity:55,colors:["#10b981","#3b82f6","#6366f1"]}),n(.2,{spread:60,colors:["#10b981","#3b82f6","#6366f1"]}),n(.35,{spread:100,decay:.91,scalar:.8,colors:["#10b981","#3b82f6","#6366f1"]}),n(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#10b981","#3b82f6","#6366f1"]}),n(.1,{spread:120,startVelocity:45,colors:["#10b981","#3b82f6","#6366f1"]})}async function y(){try{document.getElementById("sourcesCount").textContent="0",document.getElementById("gamesCount").textContent="0",document.getElementById("actionsCount").textContent="0";const t=(await B()).sources,n=document.getElementById("sourcesCount");l(n,t.length);const a=t.reduce((o,c)=>o+(parseInt(c.gamesCount)||0),0),s=document.getElementById("gamesCount");l(s,a);try{const o=new Promise((i,u)=>setTimeout(()=>u(new Error("Firebase request timed out")),5e3)),c=p(b,"sources"),r=w(c),g=(await Promise.race([r,o])).val();if(g){const i=Object.values(g).reduce((E,C)=>{const f=C.stats||{};return E+(f.installs||0)+(f.copies||0)},0),u=document.getElementById("actionsCount");l(u,i),i>=5e5&&i<=51e4&&setTimeout(x,1e3)}else document.getElementById("actionsCount").textContent="0"}catch{console.log("Firebase stats unavailable - connection limit reached or timeout"),document.getElementById("actionsCount").textContent="0"}}catch(e){console.error("Error loading statistics:",e),document.getElementById("sourcesCount").textContent="0",document.getElementById("gamesCount").textContent="0",document.getElementById("actionsCount").textContent="0"}}function l(e,t){const s=33.333333333333336;let o=0;const c=t/60,r=()=>{o+=c,o>t&&(o=t),e.textContent=Math.floor(o).toLocaleString(),o<t&&setTimeout(r,s)};r()}setInterval(y,3e5);const m=document.getElementById("language-switcher"),d=document.getElementById("language-dropdown");m.addEventListener("click",()=>{d.classList.toggle("hidden")});document.addEventListener("click",e=>{m.contains(e.target)||d.classList.add("hidden")});d.querySelectorAll("button").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.lang;I.setLocale(t),d.classList.add("hidden");const n={en:"English",ru:"Русский","pt-br":"Português"};m.querySelector("span").textContent=n[t]})});
