import{c as E,r as p,d as b,g as w,i as I}from"./index-CmcAeWeb.js";import{c as B}from"./changelog-notification-DPn7bzXV.js";async function x(){const e=new Date().getTime(),t=await fetch(`./data/resources.json?t=${e}`,{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}});if(!t.ok)throw new Error("Failed to fetch resources");return t.json()}window.addEventListener("load",async()=>{await E.initialize(),y()});function v(){const t={origin:{y:.7},spread:360,ticks:100,gravity:0,decay:.94,startVelocity:30};function o(c,s){confetti({...t,...s,particleCount:Math.floor(200*c)})}o(.25,{spread:26,startVelocity:55,colors:["#10b981","#3b82f6","#6366f1"]}),o(.2,{spread:60,colors:["#10b981","#3b82f6","#6366f1"]}),o(.35,{spread:100,decay:.91,scalar:.8,colors:["#10b981","#3b82f6","#6366f1"]}),o(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#10b981","#3b82f6","#6366f1"]}),o(.1,{spread:120,startVelocity:45,colors:["#10b981","#3b82f6","#6366f1"]})}async function y(){try{document.getElementById("sourcesCount").textContent="0",document.getElementById("gamesCount").textContent="0",document.getElementById("actionsCount").textContent="0";const t=(await x()).sources,o=document.getElementById("sourcesCount");u(o,t.length);const c=t.reduce((n,a)=>n+(parseInt(a.gamesCount)||0),0),s=document.getElementById("gamesCount");u(s,c);try{const n=new Promise((i,d)=>setTimeout(()=>d(new Error("Firebase request timed out")),5e3)),a=p(b,"sources"),r=w(a),g=(await Promise.race([r,n])).val();if(g){const i=Object.values(g).reduce((h,C)=>{const f=C.stats||{};return h+(f.installs||0)+(f.copies||0)},0),d=document.getElementById("actionsCount");u(d,i),i>=5e5&&i<=51e4&&setTimeout(v,1e3)}else document.getElementById("actionsCount").textContent="0"}catch{console.log("Firebase stats unavailable - connection limit reached or timeout"),document.getElementById("actionsCount").textContent="0"}}catch(e){console.error("Error loading statistics:",e),document.getElementById("sourcesCount").textContent="0",document.getElementById("gamesCount").textContent="0",document.getElementById("actionsCount").textContent="0"}}function u(e,t){const s=33.333333333333336;let n=0;const a=t/60,r=()=>{n+=a,n>t&&(n=t),e.textContent=Math.floor(n).toLocaleString(),n<t&&setTimeout(r,s)};r()}setInterval(y,3e5);console.log("Changelog notification system loaded:",B);const m=document.getElementById("language-switcher"),l=document.getElementById("language-dropdown");m.addEventListener("click",()=>{l.classList.toggle("hidden")});document.addEventListener("click",e=>{m.contains(e.target)||l.classList.add("hidden")});l.querySelectorAll("button").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.lang;I.setLocale(t),l.classList.add("hidden");const o={en:"English",ru:"Русский","pt-br":"Português"};m.querySelector("span").textContent=o[t]})});
